---
title: "Landuse_mapping"
output: html_document
date: "2024-04-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

# Setup
```{r setup, warning = FALSE, include=FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
library(ggplot2)
```

```{r themes}
mapTheme <- theme(plot.title =element_text(size=12),
                  plot.subtitle = element_text(size=8),
                  plot.caption = element_text(size = 6),
                  axis.line=element_blank(),
                  axis.text.x=element_blank(),
                  axis.text.y=element_blank(),
                  axis.ticks=element_blank(),
                  axis.title.x=element_blank(),
                  axis.title.y=element_blank(),
                  panel.background=element_blank(),
                  panel.border=element_blank(),
                  panel.grid.major=element_line(colour = 'transparent'),
                  panel.grid.minor=element_blank(),
                  legend.direction = "vertical", 
                  legend.position = "right",
                  plot.margin = margin(1, 1, 1, 1, 'cm'),
                  legend.key.height = unit(1, "cm"), legend.key.width = unit(0.2, "cm"))

plotTheme <- theme(
  plot.title =element_text(size=12),
  plot.subtitle = element_text(size=8),
  plot.caption = element_text(size = 6),
  axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
  axis.text.y = element_text(size = 10),
  axis.title.y = element_text(size = 10),
  # Set the entire chart region to blank
  panel.background=element_blank(),
  plot.background=element_blank(),
  #panel.border=element_rect(colour="#F0F0F0"),
  # Format the grid
  panel.grid.major=element_line(colour="#D0D0D0",size=.75),
  axis.ticks=element_blank())
```

```{r themes}
calgary_fishnet<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Fishnet.json")
calgary_boundary<-st_read("https://raw.githubusercontent.com/luyiiw/LUEM/main/Calgary_JSON/Calgary_Boundary.json")

ggplot() + 
  geom_sf(data=calgary_boundary,fill=NA, color="blue",size=0.5) +
  geom_sf(data=calgary_fishnet,color="red",size=0.2) +
  labs(title="Past Flood in Calgary")+
  mapTheme

##Design Refinement Later
```

```{Raster cleaning for Calgary Dependent}

library(raster)
library(rgdal)

#Dependent 
dependent <- raster("C:/Users/USER/Desktop/LandUseModeling/Assignment3/calgary_raster/dependent.tif")
dependent_df <- as.data.frame(dependent, xy = TRUE)

fishnet_shp<- st_read("C:/Users/USER/Desktop/LandUseModeling/Assignment3/Calgary/fishnet_boundary.shp")
st_geometry_type(fishnet_shp)

calfishnet_shp <- st_zm(fishnet_shp, drop = TRUE)

clipped_depen <- mask(dependent,calfishnet_shp)
clip_df <-as.data.frame(clipped_depen, xy=TRUE)

ggplot() +
    geom_raster(data = clip_df , aes(x = x, y = y, fill =dependent)) +
    geom_sf(data = calgary_fishnet, color = "red", fill = NA) +
    scale_fill_viridis_c() +
      coord_sf() +
    labs(title = "Raster Layer with Fishnet Overlay") +
  mapTheme





##Design Refinement Later
```



calgary_fac<-raster("C:/Users/USER/Desktop/LandUseModeling/Assignment3/calgary_raster/Calgary_fac.tif")
calgary_fac_df <- as.data.frame(dependent, xy = TRUE)

clipped_cal_fac <- mask(calgary_fac,calfishnet_shp)
cal_fac_df <-as.data.frame(clipped_cal_fac, xy=TRUE)

ggplot() +
    geom_raster(data = cal_fac_df , aes(x = x, y = y, fill =Calgary_fac)) +
    geom_sf(data = calgary_fishnet, color = "red", fill = NA) +
    scale_fill_viridis_c() +
      coord_sf() +
    labs(title = "Raster Layer with Fishnet Overlay") +
  mapTheme
  
  
##permeability  
calgary_perme<-raster("C:/Users/USER/Desktop/LandUseModeling/Assignment3/calgary_raster/calgary_perme.tif")
calgary_perme_df <- as.data.frame(calgary_perme, xy = TRUE)

clipped_cal_perme <- mask(calgary_perme,calfishnet_shp)
cal_perme_df <-as.data.frame(clipped_cal_perme, xy=TRUE)

ggplot() +
    geom_raster(data = cal_perme_df , aes(x = x, y = y, fill =calgary_perme)) +
    geom_sf(data = calgary_fishnet, color = "red", fill = NA) +
    scale_fill_viridis_c() +
      coord_sf() +
    labs(title = "Raster Layer with Fishnet Overlay") +
  mapTheme
   
  
##water
calgary_water<-raster("C:/Users/USER/Desktop/LandUseModeling/Assignment3/calgary_raster/calgary_water.tif")

clipped_cal_water <- mask(calgary_water,calfishnet_shp)
cal_water_df <-as.data.frame(clipped_cal_water, xy=TRUE)

ggplot() +
    geom_raster(data = cal_water_df , aes(x = x, y = y, fill =calgary_water)) +
    geom_sf(data = calgary_fishnet, color = "red", fill = NA) +
    scale_fill_viridis_c() +
      coord_sf() +
    labs(title = "Raster Layer with Fishnet Overlay") +
  mapTheme


##slope

calgary_slope<-raster("C:/Users/USER/Desktop/LandUseModeling/Assignment3/calgary_raster/calgary_slope.tif")

clipped_cal_slope <- mask(calgary_slope,calfishnet_shp)
cal_slope_df <-as.data.frame(clipped_cal_slope, xy=TRUE)

ggplot() +
    geom_raster(data = cal_slope_df , aes(x = x, y = y, fill =calgary_slope)) +
    geom_sf(data = calgary_fishnet, color = "red", fill = NA) +
    scale_fill_viridis_c() +
      coord_sf() +
    labs(title = "Raster Layer with Fishnet Overlay") +
  mapTheme

##Elevation

calgary_dem<-raster("C:/Users/USER/Desktop/LandUseModeling/Assignment3/calgary_raster/calgary_dem.tif")

clipped_cal_dem <- mask(calgary_dem,calfishnet_shp)
cal_dem_df <-as.data.frame(clipped_cal_dem, xy=TRUE)

ggplot() +
    geom_raster(data = cal_dem_df, aes(x = x, y = y, fill =calgary_dem)) +
    geom_sf(data = calgary_fishnet, color = "red", fill = NA) +
    scale_fill_viridis_c() +
      coord_sf() +
    labs(title = "Raster Layer with Fishnet Overlay") +
  mapTheme
  
  
##Predicted Variable











  
  
  
  
  
  
  
  
  
  